<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Shawn Melton">
<meta name="description" content="I have typed a good bit in the past year evangelizing about Visual Studio Code on social media and other forms. As a major contributor for the PowerShell module dbatools I have made VS Code my primary development tool. You may not know that I actually started out using the big brother Visual Studio 2015 Community Edition (&ldquo;VS&rdquo;) before I found VS Code. VS, now at version 2017, and the PowerShell Tools for Visual Studio have come a long way since I last used them.">

<meta property="og:title" content="Visual Studio Community" />
<meta property="og:description" content="I have typed a good bit in the past year evangelizing about Visual Studio Code on social media and other forms. As a major contributor for the PowerShell module dbatools I have made VS Code my primary development tool. You may not know that I actually started out using the big brother Visual Studio 2015 Community Edition (&ldquo;VS&rdquo;) before I found VS Code. VS, now at version 2017, and the PowerShell Tools for Visual Studio have come a long way since I last used them." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.wsmelton.info/blog/visual-studio-community/" />



<meta property="article:published_time" content="2018-01-04T19:35:00-06:00"/>

<meta property="article:modified_time" content="2018-05-13T19:43:27-05:00"/>












<title>


     Visual Studio Community 

</title>
<link rel="canonical" href="https://blog.wsmelton.info/blog/visual-studio-community/">







<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/darcula.min.css">




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="/css/reset.css?t=2018-05-23%2014%3a01%3a27.652868%20%2b0000%20GMT%20m%3d%2b0.256953901">
    <link rel="stylesheet" href="/css/pygments.css?t=2018-05-23%2014%3a01%3a27.652868%20%2b0000%20GMT%20m%3d%2b0.256953901">
    <link rel="stylesheet" href="/css/main.css?t=2018-05-23%2014%3a01%3a27.652868%20%2b0000%20GMT%20m%3d%2b0.256953901">
    




<link rel="shortcut icon"

    href="/img/favicon.ico"

>








</head>


<body lang="en">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                
                <a href="/"><img class="avatar" src="/img/myavatar.jpg" srcset="https://blog.wsmelton.info/img/myavatar.jpg 1x"></a>
            
            <a href="/"><div class="name">Shawn Melton</div></a>
            
            <nav>
                <ul>
                    
                        <li class="nav-"><a href="https://blog.wsmelton.info/"><span>latest</span></a></li>
                    
                        <li class="nav-"><a href="https://blog.wsmelton.info/blog"><span>all</span></a></li>
                    
                        <li class="nav-about"><a href="https://blog.wsmelton.info/aboutme/"><span>about</span></a></li>
                    
                        <li class="nav-tags"><a href="https://blog.wsmelton.info/tags"><span>tags</span></a></li>
                    
                        <li class="nav-projects"><a href="https://blog.wsmelton.info/projects/"><span>projects</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">
        
            <a href="//github.com/wsmelton" target="_blank" rel="noopener"><img class="icon" src="/img/github.svg" alt="github" /></a>
        

        
            <a href="//twitter.com/wsmelton" target="_blank" rel="noopener"><img class="icon" src="/img/twitter.svg" alt="twitter" /></a>
        

	

        

        

        
            <a href="//linkedin.com/in/wshawnmelton" target="_blank" rel="noopener"><img class="icon" src="/img/linkedin.svg" alt="linkedin" /></a>
        

        

        

        

        

        

        

        
        </div>
    </div>
</section>


<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    Visual Studio Community

</div>

                    <div class="initials"><a href="https://blog.wsmelton.info/"></a></div>
                </div>
                <div class="meta">
                    
                    <div class="date" title='Thu 4 Jan 2018 19:35 CDT'>4 Jan 2018</div>
                    
                    
		    <div class="reading-time"><div class="middot"></div>7 minutes read</div>
                    
                </div>
            </div>
            <div class="markdown">
                

<p>I have typed a good bit in the past year evangelizing about Visual Studio Code on social media and other forms. As a major contributor for the PowerShell module <a href="https://dbatools.io" target="blank">dbatools</a> I have made VS Code my primary development tool. You may not know that I actually started out using the big brother Visual Studio 2015 Community Edition (&ldquo;VS&rdquo;) before I found VS Code. VS, now at version 2017, and the <a href="https://marketplace.visualstudio.com/items?itemName=AdamRDriscoll.PowerShellToolsforVisualStudio2017-18561" target="_blank">PowerShell Tools for Visual Studio</a> have come a long way since I last used them. The PowerShell extension in VS is maintained by <a href="https://github.com/adamdriscoll/poshtools" target="_blank">Adam Driscoll</a>. In this post, I thought I would take you through getting VS 2017 installed and setup for PowerShell development. I will go over how to get VS setup for contributing to a GitHub project. <em>We will obviously use dbatools as the example repository.</em></p>

<!-- TOC -->

<ul>
<li><a href="#install">Install</a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#versions">Versions</a></li>
<li><a href="#vs---solutions-projects-and-now-folders">VS - Solutions, Projects and now Folders</a></li>
<li><a href="#starting-new">Starting New</a></li>
<li><a href="#starting-from-current-github-project">Starting From Current GitHub Project</a>

<ul>
<li><a href="#cloning-the-repository">Cloning the Repository</a></li>
</ul></li>
<li><a href="#caveats-with-powershell-projects">Caveats with PowerShell Projects</a></li>
</ul>

<!-- /TOC -->

<h3 id="install">Install</h3>

<p>The first step is to download the installer from <a href="https://visualstudio.com/free-developer-offers">here</a>. You will also need to <a href="https://git-scm.com/download/win">download Git for Windows</a> on your machine. The install for Git is very basic (just click next), so I will not go over that installation. I will walk through the installation of Visual Studio 2017 Community Edition below showing the screenshots in the order I received:</p>

<p><img src="/img/vs-install_1.png" alt="" /></p>

<p>Click continue</p>

<p><img src="/img/vs-install_2.png" alt="" /></p>

<p>At this point, you are prompted to select a workload and individual components. You can go through and select the ones you desire, but I am opting to skip this process right now. (Adding more workloads does add on time for the install process).</p>

<p><img src="/img/vs-install_3.png" alt="" /></p>

<p>You will get a screen showing the installation progress (VS updates will also have this same prompt now as well):</p>

<p><img src="/img/vs-install_4.png" alt="" /></p>

<p>Once that is completed you can click on &ldquo;Launch&rdquo; button:</p>

<p><img src="/img/vs-install_5.png" alt="" /></p>

<p>One final step before VS opens is to <a href="https://msdn.microsoft.com/en-us/library/dn457348.aspx#Anchor_0">sign in with your Live account</a>.</p>

<p><img src="/img/vs-install_6.png" alt="" /></p>

<p><img src="/img/vs-install_7.png" alt="" /></p>

<p>You should now be presented with something similar to this:</p>

<p><img src="/img/vs-install_8.png" alt="" /></p>

<h3 id="extensions">Extensions</h3>

<p>Now that we have VS installed we will need to add the PowerShell extension. Start by going to Tools &gt; Extensions and Updates&hellip;</p>

<p><img src="/img/vs-install_9.png" alt="" /></p>

<ol>
<li>Select &ldquo;Online&rdquo;</li>
<li>Search for &ldquo;PowerShell&rdquo;</li>
<li>Select &ldquo;PowerShell Tools for Visual Studio&rdquo;</li>
<li>Click Download</li>
</ol>

<p><img src="/img/vs-install_10.png" alt="" /></p>

<p>Once that download completes you can close that window, and then exit out of Visual Studio. It will vary but after a few seconds, you will see the VSIX Installer open up and begin installing the extensions.</p>

<p>It will first initialize and then give you a prompt to click &ldquo;Modify&rdquo; for the install to continue:</p>

<p><img src="/img/vs-install_12.png" alt="" /></p>

<p><img src="/img/vs-install_13.png" alt="" /></p>

<p>On my machine, the install of the PowerShell extension took close to a full hour. Once the extension install is complete, just click &ldquo;Close&rdquo;:</p>

<p><img src="/img/vs-install_14.png" alt="" /></p>

<h3 id="versions">Versions</h3>

<p>The remainder of this post and screenshots will focus on the following versions of VS and PowerShell extension on my machine:</p>

<ul>
<li>Visual Studio Community 2017 - 15.5.1</li>
<li>PowerShell Tools for VS - 3.0.585</li>
</ul>

<h3 id="vs-solutions-projects-and-now-folders">VS - Solutions, Projects and now Folders</h3>

<p>If you have used SSDT with the Business Intelligence projects you may be familiar with Visual Studio&rsquo;s use of <a href="https://docs.microsoft.com/en-us/visualstudio/ide/solutions-and-projects-in-visual-studio">solutions and projects</a> to organize things. This was the core configuration of how you worked in VS. As times have changed so has VS and in VS 2015 release they added support for using a root folder as your solution. So you can now open a PowerShell module root folder as a solution in VS. Which if you have used VS Code this works the same way. A reason for adding the folder support was because of GitHub, which a high majority of PowerShell projects on GitHub will not include the VS solution and project files.</p>

<p>There is a downside to the folder support in VS: No project template is associated with it. What that means is you can open a PowerShell module in VS as easily as just pointing it at the root folder of your module, but you will not get all the bells and whistles that PowerShell Tools for VS includes. I have not found a clean way of just &ldquo;importing&rdquo; a PowerShell module from GitHub into a PowerShell Tools project in VS, so the steps I will show you later may seem a bit wonky but it is the only way I&rsquo;ve found that works.</p>

<h3 id="starting-new">Starting New</h3>

<p>If you are developing a brand new PowerShell module, you simply use the PowerShell Module project template. You can do this via File &gt; New &gt; Project, then select the template and give it a name.</p>

<p><img src="/img/vs-install_15.png" alt="" /></p>

<p>This will create a very basic module file structure. You can check the box for &ldquo;Create new Git repository&rdquo; if you would like the directory initialized as a local repository.</p>

<p><img src="/img/vs-install_16.png" alt="" /></p>

<p>I like to have the test files put in a test folder, so you can create a folder and just drag that test file into that folder. The next step is to right-click on the project and go to Properties so you can set the manifest information:</p>

<p><img src="/img/vs-install_17.png" alt="" /></p>

<p>I only set the root module, this will be what is run when you do <code>Import-Module MyFirstModule</code>. I then gave it a description and adjust the version information to my preferences. You can use the GUI to adjust the other information in the manifest or simply open the &ldquo;psd1&rdquo; file in the editor. It is just your preference, although I did find that updating the file directly does not seem to update the UI properties for some reason (not sure if this is a bug or not).</p>

<p>I&rsquo;m not going to go over module design and such in this post, but after you get done updating the manifest you are ready to start developing your new module. I&rsquo;m going to next touch on starting with a currently published project on GitHub, called dbatools.</p>

<h3 id="starting-from-current-github-project">Starting From Current GitHub Project</h3>

<p>The majority of any PowerShell module worth its weight and use nowadays is found on the PowerShell Gallery, with the code hosted on GitHub as the source control provider. If you want to get started contributing to public PowerShell modules, whether they are from Microsoft or the community, I will walk through doing this with the <a href="https://github.com/sqlcollaborative/dbatools">dbatools repository</a>. The same steps will apply to any repository on GitHub that you can use VS as your development IDE.</p>

<h4 id="cloning-the-repository">Cloning the Repository</h4>

<p>You can clone or do the initial pull of a repository a few different ways. It depends on whether you want to use the GitHub.com interface or VS itself. It is best to use VS as this will also initialize Git for that local folder (repository).</p>

<p>To start you will go to the &ldquo;Team Explorer&rdquo; window and click on &ldquo;Clone&rdquo;. You will need to provide the URL to the GitHub repository, in this case, I&rsquo;m using my forked repository of dbatools. Just provide a local path, you can use the default if you want but I keep all of the repositories I contribute to under <code>C:\GitHub</code></p>

<p><img src="/img/vs-install_18.png" alt="" /></p>

<p>Just click on the &ldquo;Clone&rdquo; button and it will begin to pull down all the files for the repository. Once that is complete VS will open the Solution Explorer and you will see the folder view of the dbatools modules.</p>

<p><img src="/img/vs-install_19.png" alt="" /></p>

<p>If you click on the &ldquo;Solutions and Folders&rdquo; button you will notice with the dbatools repository there is a solution file found. This is the C# project for the &ldquo;dbatools.dll&rdquo; and library source code. If you are interested, selecting the &ldquo;sln&rdquo; file will open that view in Solutions Explorer and you can traverse the code for that side of the module.</p>

<h3 id="caveats-with-powershell-projects">Caveats with PowerShell Projects</h3>

<p>With projects already on GitHub or hosted from another provider, unless the author uploaded the project as a Visual Studio PowerShell module project you will not be able to utilize features of the extension. Sadly there is no method or process in Visual Studio that lets &ldquo;import&rdquo; a non-project into a project template. Your only option would be to manually add the folders directly to the project file (via xml elements) and then you can add the files all at one time. It is a very manual process sadly.</p>

<p>Some time down the road maybe Adam or someone from the VS team will offer the ability to import folders and files into a project more easily, but right now it is an all manual process. If you are comfortable using Visual Studio you will find the time worth it, because it would just be a one time thing with the exception of new files from the repository being added upstream.</p>

                <br>
                
                <p class="back-to-posts"><a href="/blog/">Back to posts</a></p>
            </div>
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</section>



<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-85098649-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  

  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
  </script>





</body>
</html>

