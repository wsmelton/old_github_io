<!DOCTYPE html>
<html lang="en-us">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Shawn Melton">
<meta name="description" content="Maybe you are tired of AdventureWorks or if you are still old school with Northwnd and Pubs? Brent Ozar has for many years now been using [StackOverflow database](&ldquo;http://www.brentozar.com/archive/2014/01/how-to-query-the-stackexchange-databases/&quot;) in his training and demos. As StackExchange (SE) started providing public [archives of the SE network sites](&ldquo;https://archive.org/details/stackexchange&quot;).
I wanted to be able to build out a sample database on all of these archives as I needed, so wrote a PowerShell module.">

<meta property="og:title" content="StackDb PowerShell Module" />
<meta property="og:description" content="Maybe you are tired of AdventureWorks or if you are still old school with Northwnd and Pubs? Brent Ozar has for many years now been using [StackOverflow database](&ldquo;http://www.brentozar.com/archive/2014/01/how-to-query-the-stackexchange-databases/&quot;) in his training and demos. As StackExchange (SE) started providing public [archives of the SE network sites](&ldquo;https://archive.org/details/stackexchange&quot;).
I wanted to be able to build out a sample database on all of these archives as I needed, so wrote a PowerShell module." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.wsmelton.info/fixed/projects/" />




<meta property="article:modified_time" content="2018-05-13T19:43:27-05:00"/>












<title>


     StackDb PowerShell Module 

</title>
<link rel="canonical" href="https://blog.wsmelton.info/fixed/projects/">







<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/darcula.min.css">




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="/css/reset.css?t=2018-05-23%2014%3a01%3a27.8198687%20%2b0000%20GMT%20m%3d%2b0.423954601">
    <link rel="stylesheet" href="/css/pygments.css?t=2018-05-23%2014%3a01%3a27.8198687%20%2b0000%20GMT%20m%3d%2b0.423954601">
    <link rel="stylesheet" href="/css/main.css?t=2018-05-23%2014%3a01%3a27.8198687%20%2b0000%20GMT%20m%3d%2b0.423954601">
    




<link rel="shortcut icon"

    href="/img/favicon.ico"

>








</head>


<body lang="en">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                
                <a href="/"><img class="avatar" src="/img/myavatar.jpg" srcset="https://blog.wsmelton.info/img/myavatar.jpg 1x"></a>
            
            <a href="/"><div class="name">Shawn Melton</div></a>
            
            <nav>
                <ul>
                    
                        <li class="nav-"><a href="https://blog.wsmelton.info/"><span>latest</span></a></li>
                    
                        <li class="nav-"><a href="https://blog.wsmelton.info/blog"><span>all</span></a></li>
                    
                        <li class="nav-about"><a href="https://blog.wsmelton.info/aboutme/"><span>about</span></a></li>
                    
                        <li class="nav-tags"><a href="https://blog.wsmelton.info/tags"><span>tags</span></a></li>
                    
                        <li class="nav-projects"><a href="https://blog.wsmelton.info/projects/"><span>projects</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">
        
            <a href="//github.com/wsmelton" target="_blank" rel="noopener"><img class="icon" src="/img/github.svg" alt="github" /></a>
        

        
            <a href="//twitter.com/wsmelton" target="_blank" rel="noopener"><img class="icon" src="/img/twitter.svg" alt="twitter" /></a>
        

	

        

        

        
            <a href="//linkedin.com/in/wshawnmelton" target="_blank" rel="noopener"><img class="icon" src="/img/linkedin.svg" alt="linkedin" /></a>
        

        

        

        

        

        

        

        
        </div>
    </div>
</section>

<section class="main">
    <div class="container">
        <div class="content">
            <div class="page-heading">

    StackDb PowerShell Module

</div>

            <div class="markdown">
                

<p>Maybe you are tired of AdventureWorks or if you are still old school with Northwnd and Pubs? Brent Ozar has for many years now been using [StackOverflow database](&ldquo;<a href="http://www.brentozar.com/archive/2014/01/how-to-query-the-stackexchange-databases/&quot;">http://www.brentozar.com/archive/2014/01/how-to-query-the-stackexchange-databases/&quot;</a>) in his training and demos. As StackExchange (SE) started providing public [archives of the SE network sites](&ldquo;<a href="https://archive.org/details/stackexchange&quot;">https://archive.org/details/stackexchange&quot;</a>).</p>

<p>I wanted to be able to build out a sample database on all of these archives as I needed, so wrote a PowerShell module.</p>

<h1 id="where-to-get-it">Where to get it?</h1>

<p>You can find the files in my GitHub repository, <a href="https://github.com/wsmelton/PSStackExchangeDb">PSStackExchangeDb</a>.</p>

<h1 id="a-short-example">A short example&hellip;</h1>

<pre><code class="language-powershell">&lt;# Refresh module in cache to get latest #&gt;
#rmo PSStackExchangeDb
ipmo C:\GitHub\PSStackExchangeDb\PSStackExchangeDb.psd1

&lt;# See if site exist and what file size is #&gt;
Get-SEArchive -siteName woodworking -listAvailable

&lt;# download archive file #&gt;
Get-SEArchive -siteName Woodworking -downloadPath C:\temp\SESites -Verbose

&lt;# export 7z file #&gt;
Export-SEArchive -filename C:\temp\SESites\Woodworking.stackexchange.com.7z -Verbose
# see files
Get-ChildItem C:\temp\SESites\Woodworking.stackexchange.com

&lt;# Create database and import data from xml files #&gt;
# Create database (must not already exist)
New-SEDatabase -sqlServer manatarms -databaseName Woodworking -Verbose
# Import xml files
Import-SEArchive -filepath C:\temp\SESites\Woodworking.stackexchange.com -sqlserver manatarms -database Woodworking -Verbose

# Or if want to reload specific table (purge it first)
Invoke-Sqlcmd -serverinstance manatarms -database Woodworking -Query &quot;DELETE FROM Posts&quot;
Import-SEArchive -filepath C:\Temp\SESites\Woodworking.stackexchange.com -sqlserver manatarms -database Woodworking -tableList 'Posts'
</code></pre>

<p>Recording of the above code:</p>

<video src="/img/PSStackExchange_Example_Woodworking.mp4" width="600" height="400" controls preload></video>

            </div>
        </div>
    </div>
</section>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-85098649-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  

  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
  </script>





</body>
</html>

